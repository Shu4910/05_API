<!DOCTYPE html>
<html>
  <head>
    <title>Current Location</title>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA3kO2w0_C6H9HovP317lJWtbJf88aMfYY"></script>
    <link rel="stylesheet" type="text/css" href="css/styles.css">
    <script src="./index2.js"></script>
  </head>


  <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
<!-- Firestore -->
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>

<!-- 9.1.0ではうまくいかない理由とgitigonoreの方法を教えてください -->


<body>
  <h1>森田Tシャツ購入サイト🤗</h1>
  <p class="kounyu">送付する住所を入力してください。</p>
  <button id="getLocationButton">現在地から取得して入力する</button>
  <br>
  <p>郵便番号を入力して、住所を取得する</div></p>
  <form id="centerForm">
    <table>
        <tbody>
            <tr>
                <th>郵便番号</th>
                <td class="zipcode-cell">
                    <input id="input" class="zipcode" type="text" name="zipcode" value="" placeholder="例)8120012">
                    <button id="search" type="button">住所検索</button>
                    <p id="error"></p>
                </td>
            </tr>

            <tr>
                <th>都道府県</th>
                <td><input id="address1" type="text" name="address1" value=""></td>
            </tr>

            <tr>
                <th>市区町村</th>
                <td><input id="address2" type="text" name="address2" value=""></td>
            </tr>

            <tr>
                <th>町域</th>
                <td><input id="address3" type="text" name="address3" value=""></td>
            </tr>

            <tr>
              <th>番地</th>
              <td><input id="address4" type="text" name="address4" value=""></td>
          </tr>

          <tr>
            <th>マンション名・部屋番号</th>
            <td><input id="address5" type="text" name="address5" value=""></td>
        </tr>

        <tr>
            <th>宛名</th>
            <td><input id="address6" type="text" name="address6" value=""></td>
        </tr>



        </tbody>
    </table>
</form>
<br>
<button id="moveToPurchaseSite">購入サイトに移動する</button>
</body>


<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-database.js"></script>
<script src="keys/firebase.js"></script>


<script>
// Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  // saveToFirebase.js

function saveToFirebase() {
  // Get form values
  const zipcode = document.getElementById('input').value;
  const prefecture = document.getElementById('address1').value;
  const city = document.getElementById('address2').value;
  const town = document.getElementById('address3').value;
  const street = document.getElementById('address4').value;
  const apartment = document.getElementById('address5').value;
  const name = document.getElementById('address6').value;


      // Check if zipcode is empty
      if (!zipcode || !prefecture || !city || !town || !street || !apartment || !name) {
        alert("空欄の項目があります！森田激おこぷんぷん丸です😡");
        return;
    }

  // Reference to your Firebase database
  var dbRef = firebase.database().ref();

  // Data to save
  var dataToSave = {
    zipcode: zipcode,
    prefecture: prefecture,
    city: city,
    town: town,
    street: street,
    apartment: apartment,
    name: name
  };

  // Save to Firebase
  dbRef.push(dataToSave, function(error) {
    if (error) {
      console.log("Data could not be saved." + error);
    } else {
      console.log("Data saved successfully.");

      // Move to purchase site
      location.href='index2.html';
    }
  });
}

// Attach click event listener to the button
document.getElementById('moveToPurchaseSite').addEventListener('click', saveToFirebase);

</script>


<script src="https://cdn.jsdelivr.net/npm/fetch-jsonp@1.1.3/build/fetch-jsonp.min.js"></script>
<script src="js/script.js"></script>

</html>
